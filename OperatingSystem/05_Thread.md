# Thread

## 개요

- CPU 이용의 기본 단위이다.
- 스레드의 구성 요소
    - 스레드 ID
    - 프로그램 카운터(PC)
    - 레지스터 집합
    - 스택
- 같은 프로세스에서 공유하는 자원
    - 코드
    - 데이터 섹션
    - 열린 파일이나 신호와 같은 운영체제 자원들

## 스레드 사용 시 장점

- 응답성
    - 단일 스레드 응용 프로그램은 그 연산이 완료될 때까지 사용자에게 응답하지 않을 것이다.
    - 하지만 비동기적 스레드에서 실행된다면 여전히 사용자에게 응답할 수 있다.
- 자원 공유
    - 프로세스는 공유 메모리(shared Memory)와 메세지 전달(message Parsing) 기법을 통해서만 자원을 공유할 수 있다. → 프로그래머가 명시해야 함.
    - 스레드는 자동으로 그들이 속한 프로세스의 자원들과 메모리를 공유한다.
    - 코드와 데이터 공유의 이점은 한 응용 프로그램이 같은 주소 공간 내에 여러 개의 다른 작업을 하는 스레드를 가질 수 있다는 점이다.
- 경제성
    - 프로세스 생성을 위해 메모리와 자원을 할당하는 것은 비용이 많이 드는 작업이다.
    - 스레드는 자신이 속한 프로세스의 자원들을 공유하기 때문에, 스레드를 생성하고 문맥교환하는 것이 더욱더 경제적이다. 오버헤드의 차이를 경험적으로 측정하는 것은 어려울 수 있지만, 일반적으로 스레드 생성은 프로세스 생성보다 시간과 메모리를 덜 소비한다. 또한 문맥 교환은 일반적으로 프로세스 사이보다 스레드 사이에서 더 빠르다.
- 규모 적응성
    - 다중 처리기 구조에서는 각각의 스레드가 다른 처리기에서 병렬로 수행될 수 있기 때문에 다중 스레드의 이점이 더욱 증가한다.
    

## 병렬 실행의 유형

- 데이터 병렬 실행
    - 동일한 데이터의 부분집합을 다수의 계산 코어에 분배한 뒤 각 코어에서 동일한 연산을 실행
        
        예시: 배열의 1~n 까지 합을 계산 하면 1~[n/2-1]을 합하고 [n/2]~n 합 연산을 각자의 계산 코어에 분배한다.
        
- 테스크 병렬 실행
    - 테스크(스레드를) 다수의 코어에 분배한다. 각 스레드는 고유의 연산을 실행한다. 각각의 스레드들이 동일한 데이터에 대한 연산을 실행할 수도 있고 아닐 수도 있다.

## 다중 스레드 모델

- 사용자 스레드
    - 사용자 수준에서 제공되는 스레드
    - 커널 위에서 지원되며, 커널의 지원 없이 관리된다.
- 커널 스레드
    - 커널 수준에서 제공되는 스레드
    - 운영체제에 의해 직접 지원되고 관리 된다.